
<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
		<title>src: Go Coverage Report</title>
		<style>
			body {
				background: black;
				color: rgb(80, 80, 80);
			}
			body, pre, #legend span {
				font-family: Menlo, monospace;
				font-weight: bold;
			}
			#topbar {
				background: black;
				position: fixed;
				top: 0; left: 0; right: 0;
				height: 42px;
				border-bottom: 1px solid rgb(80, 80, 80);
			}
			#content {
				margin-top: 50px;
			}
			#nav, #legend {
				float: left;
				margin-left: 10px;
			}
			#legend {
				margin-top: 12px;
			}
			#nav {
				margin-top: 10px;
			}
			#legend span {
				margin: 0 5px;
			}
			.cov0 { color: rgb(192, 0, 0) }
.cov1 { color: rgb(128, 128, 128) }
.cov2 { color: rgb(116, 140, 131) }
.cov3 { color: rgb(104, 152, 134) }
.cov4 { color: rgb(92, 164, 137) }
.cov5 { color: rgb(80, 176, 140) }
.cov6 { color: rgb(68, 188, 143) }
.cov7 { color: rgb(56, 200, 146) }
.cov8 { color: rgb(44, 212, 149) }
.cov9 { color: rgb(32, 224, 152) }
.cov10 { color: rgb(20, 236, 155) }

		</style>
	</head>
	<body>
		<div id="topbar">
			<div id="nav">
				<select id="files">
				
				<option value="file0">practica2/src/aux.go (13.2%)</option>
				
				<option value="file1">practica2/src/delete.go (0.0%)</option>
				
				<option value="file2">practica2/src/display.go (0.0%)</option>
				
				<option value="file3">practica2/src/main.go (0.0%)</option>
				
				<option value="file4">practica2/src/menu.go (0.0%)</option>
				
				<option value="file5">practica2/src/modify.go (0.0%)</option>
				
				<option value="file6">practica2/src/new.go (4.4%)</option>
				
				</select>
			</div>
			<div id="legend">
				<span>not tracked</span>
			
				<span class="cov0">not covered</span>
				<span class="cov8">covered</span>
			
			</div>
		</div>
		<div id="content">
		
		<pre class="file" id="file0" style="display: none">package main

import (
        "bufio"
        "fmt"
        "os"
)

// contar plazas libres
func (g *Garage) availableSlots() int <span class="cov8" title="1">{
        var count int = 0

        for _, s := range g.slots </span><span class="cov8" title="1">{
                if s.vehicleID == nil </span><span class="cov8" title="1">{
                        count++
                }</span>
        }
        <span class="cov8" title="1">return count</span>
}

// devuelve si un vehículo está en una plaza del taller
func (g *Garage) vIsInSlot(vid VehicleID) bool <span class="cov0" title="0">{
        for _, v := range g.slots </span><span class="cov0" title="0">{
                if v.vehicleID != nil &amp;&amp; *v.vehicleID == vid </span><span class="cov0" title="0">{
                        return true
                }</span>
        }
        <span class="cov0" title="0">return false</span>
}

func removeVID(slice []VehicleID, id VehicleID) []VehicleID <span class="cov0" title="0">{
        for i, v := range slice </span><span class="cov0" title="0">{
                if v == id </span><span class="cov0" title="0">{
                        return append(slice[:i], slice[i+1:]...)
                }</span>
        }
        <span class="cov0" title="0">return slice</span>
}

// devuelve si un mecánico está libre
func isFree(m *Mechanic) bool <span class="cov0" title="0">{
        return len(m.issues) == 0 &amp;&amp; m.status == ACTIVE
}</span>

// devuelve si un mecanicos está sociado a una incidencia especifica o no
func isInIncidence(i *Incidence, m MechanicID) bool <span class="cov0" title="0">{
        for _, mid := range i.mechanics </span><span class="cov0" title="0">{
                if mid == m </span><span class="cov0" title="0">{
                        return true
                }</span>
        }
        <span class="cov0" title="0">return false</span>
}

// eliminar mecánicos de una incidencia
func (g *Garage) removeMechsFromIssue(issue *Incidence) <span class="cov0" title="0">{
        var midtodel MechanicID
        var m *Mechanic

        if len(issue.mechanics) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(La incidencia no tiene mecanicos asignados)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("Lista de mecánicos de la incidencia.\n")
        for _, mid := range issue.mechanics </span><span class="cov0" title="0">{
                m := g.getMechByID(mid)
                fmt.Printf("        - ID: %d. Nombre: %s\n", m.id, m.name)
        }</span>
        <span class="cov0" title="0">fmt.Println()
        midtodel = MechanicID(askUniqueIntID("Introduzca el ID del mecánico a quitar: ", func(n int64) bool </span><span class="cov0" title="0">{ return !g.mechIDexists(MechanicID(n)) }</span>))
        <span class="cov0" title="0">for idx, mid := range issue.mechanics </span><span class="cov0" title="0">{
                if mid == midtodel </span><span class="cov0" title="0">{
                        issue.mechanics = append(issue.mechanics[:idx], issue.mechanics[idx+1:]...)
                }</span>
        }
        <span class="cov0" title="0">m = g.getMechByID(midtodel)
        for idx, issueID := range m.issues </span><span class="cov0" title="0">{
                if issueID == issue.id </span><span class="cov0" title="0">{
                        m.issues = append(m.issues[:idx], m.issues[idx+1:]...)
                }</span>
        }
}

// asignar mecánicos a una incidencia
func (g *Garage) assignMechsToIssue(i *Incidence) <span class="cov0" title="0">{
        var mcomp []Mechanic
        var option int
        var mech *Mechanic

        for _, m := range g.mechanics </span><span class="cov0" title="0">{
                if string(i.kind) == string(m.skill) &amp;&amp; !isInIncidence(i, m.id) &amp;&amp; m.status == ACTIVE </span><span class="cov0" title="0">{
                        mcomp = append(mcomp, *m)
                }</span>
        }
        <span class="cov0" title="0">if len(mcomp) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("No hay mecánicos compatibles. Contrate uno especializado en %s.\n", i.kind)
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("Asignación de Mecánicos:\n\n")
        for </span><span class="cov0" title="0">{
                fmt.Printf("Mecánicos especializados en %s:\n", i.kind)
                for i, m := range mcomp </span><span class="cov0" title="0">{
                        fmt.Printf("        %d. Nombre: %s. ID: %d\n", i+1, m.name, m.id)
                }</span>
                <span class="cov0" title="0">fmt.Printf("        %d. No asignar más\n", len(mcomp)+1)
                fmt.Printf("\nEscoja uno(rango 1 - %d): ", len(mcomp)+1)
                fmt.Scanf("%d", &amp;option)
                if option &lt; 1 || option &gt; (len(mcomp)+1) </span><span class="cov0" title="0">{
                        fmt.Printf("Opción inválida. Pruebe de nuevo.\n")
                }</span> else<span class="cov0" title="0"> if option == (len(mcomp) + 1) </span><span class="cov0" title="0">{
                        return
                }</span> else<span class="cov0" title="0"> {
                        mech = g.getMechByID(mcomp[option-1].id)
                        mech.issues = append(mech.issues, i.id)
                        i.mechanics = append(i.mechanics, mcomp[option-1].id)
                        mcomp = append(mcomp[:option-1], mcomp[option:]...)
                        if len(mcomp) == 0 </span><span class="cov0" title="0">{
                                fmt.Printf("No quedan más mecánicos compatibles.\n")
                                return
                        }</span>
                }
                <span class="cov0" title="0">fmt.Println()</span>
        }
}

// pedir una string normal
func askStr(prompt string) string <span class="cov0" title="0">{
        fmt.Printf("%s", prompt)
        scanner := bufio.NewScanner(os.Stdin)
        scanner.Scan()
        return scanner.Text()
}</span>

// pedir un ID único de tipo entero54
func askUniqueIntID(prompt string, exists func(int64) bool) int64 <span class="cov0" title="0">{
        var id int64
        for </span><span class="cov0" title="0">{
                fmt.Print(prompt)
                fmt.Scanf("%d", &amp;id) //fmt.Scanln()
                if id &lt;= 0 </span><span class="cov0" title="0">{
                        fmt.Println("Debe ser &gt; 0.")
                        continue</span>
                }
                <span class="cov0" title="0">if exists(id) </span><span class="cov0" title="0">{
                        fmt.Println("Incorrecto, pruebe otro.")
                        continue</span>
                }
                <span class="cov0" title="0">return id</span>
        }
}

// pedir una matrícula única de tipo string
func askUniqueStrID(prompt string, exists func(string) bool) string <span class="cov0" title="0">{
        var s string
        for </span><span class="cov0" title="0">{
                fmt.Print(prompt)
                fmt.Scanf("%s", &amp;s) //fmt.Scanln()
                if s == "" </span><span class="cov0" title="0">{
                        fmt.Println("No puede estar vacío.")
                        continue</span>
                }
                <span class="cov0" title="0">if exists(s) </span><span class="cov0" title="0">{
                        fmt.Println("Incorrecta, pruebe otro.")
                        continue</span>
                }
                <span class="cov0" title="0">return s</span>
        }
}

// OBTENER si una incidencia existe
func (g *Garage) issueIDexists(id IncidenceID) bool <span class="cov0" title="0">{
        for _, i := range g.issues </span><span class="cov0" title="0">{
                if i.id == id </span><span class="cov0" title="0">{
                        return true
                }</span>
        }
        <span class="cov0" title="0">return false</span>
}

// OBTENER si una MATRICULA existe
func (g *Garage) vidExists(vid VehicleID) bool <span class="cov0" title="0">{
        for _, v := range g.vehicles </span><span class="cov0" title="0">{
                if v.id == vid </span><span class="cov0" title="0">{
                        return true
                }</span>
        }
        <span class="cov0" title="0">return false</span>
}

// OBTENER si un ID de un cliente existe
func (g *Garage) ownerIDexists(id ClientID) bool <span class="cov0" title="0">{
        for _, c := range g.clients </span><span class="cov0" title="0">{
                if c.id == id </span><span class="cov0" title="0">{
                        return true
                }</span>
        }
        <span class="cov0" title="0">return false</span>
}

// OBTENER si un ID de un mecánico existe
func (g *Garage) mechIDexists(id MechanicID) bool <span class="cov0" title="0">{
        for _, m := range g.mechanics </span><span class="cov0" title="0">{
                if m.id == id </span><span class="cov0" title="0">{
                        return true
                }</span>
        }
        <span class="cov0" title="0">return false</span>
}

// OBTENER si un VEHICULO de un CLIENTE está en el taller
func (g *Garage) hasVInSlot(c *Client) bool <span class="cov0" title="0">{
        for _, vid := range c.vehicles </span><span class="cov0" title="0">{
                for _, s := range g.slots </span><span class="cov0" title="0">{
                        if s.vehicleID != nil &amp;&amp; *s.vehicleID == vid </span><span class="cov0" title="0">{
                                return true
                        }</span>
                }
        }
        <span class="cov0" title="0">return false</span>
}

// OBTENER un * a CLIENTE a partir de su CLAVE
func (g *Garage) getClientByID(id ClientID) *Client <span class="cov0" title="0">{
        for _, c := range g.clients </span><span class="cov0" title="0">{
                if c.id == id </span><span class="cov0" title="0">{
                        return c
                }</span>
        }
        <span class="cov0" title="0">return nil</span>
}

// OBTENER un * a MECÁNICO a partir de su CLAVE
func (g *Garage) getMechByID(id MechanicID) *Mechanic <span class="cov0" title="0">{
        for _, m := range g.mechanics </span><span class="cov0" title="0">{
                if m.id == id </span><span class="cov0" title="0">{
                        return m
                }</span>
        }
        <span class="cov0" title="0">return nil</span>
}

// OBTENER un * a INCIDENCIA a partir de su CLAVE
func (g *Garage) getIssueByID(id IncidenceID) *Incidence <span class="cov8" title="1">{
        for _, i := range g.issues </span><span class="cov8" title="1">{
                if i.id == id </span><span class="cov8" title="1">{
                        return i
                }</span>
        }
        <span class="cov0" title="0">return nil</span>
}

// OBTENER un * a VEHICULO a partir de su CLAVE
func (g *Garage) getVByID(vid VehicleID) *Vehicle <span class="cov0" title="0">{
        for _, v := range g.vehicles </span><span class="cov0" title="0">{
                if v.id == vid </span><span class="cov0" title="0">{
                        return v
                }</span>
        }
        <span class="cov0" title="0">return nil</span>
}

func (g *Garage) checkAlert() <span class="cov0" title="0">{
        for </span><span class="cov0" title="0">{
                select </span>{
                case req := &lt;-g.hirereqs:<span class="cov0" title="0">
                        fmt.Printf("----------------------------------------------------------\n")
                        fmt.Printf("[ALERTA] Es necesario contratar un mecánico nuevo para %s.\n", req.vid)
                        fmt.Printf("----------------------------------------------------------\n\n")
                        mech := g.newMech()
                        req.Reply &lt;- mech
                        continue</span> // volvemos al inicio del for (por si hay más peticiones)
                default:<span class="cov0" title="0">
                        return</span>
                }
        }
}

// CountVehiclesWithSingleIssue cuenta cuántos vehículos tienen
// exactamente 1 incidencia, y esa incidencia es del tipo "kind".
// esto es para el primer test
func (g *Garage) CountVehiclesWithSingleIssue(kind IssueType) int <span class="cov8" title="1">{
        count := 0

        for _, v := range g.vehicles </span><span class="cov8" title="1">{
                if len(v.issues) != 1 </span><span class="cov0" title="0">{
                        continue</span>
                }
                <span class="cov8" title="1">inc := g.getIssueByID(v.issues[0])
                if inc != nil &amp;&amp; inc.kind == kind </span><span class="cov8" title="1">{
                        count++
                }</span>
        }
        <span class="cov8" title="1">return count</span>
}

func (g *Garage) countSkill(skill SkillType) int <span class="cov8" title="1">{
        var count int = 0

        for _, m := range g.mechanics </span><span class="cov8" title="1">{
                if m.skill == skill </span><span class="cov8" title="1">{
                        count++
                }</span>
        }
        <span class="cov8" title="1">return count</span>
}
</pre>
		
		<pre class="file" id="file1" style="display: none">package main

import "fmt"

// eliminación de un cliente
func (g *Garage) delClient() <span class="cov0" title="0">{
        var id ClientID
        var c *Client

        if len(g.clients) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay clientes que eliminar)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Eliminación de 1 cliente ===\n\n")
        fmt.Printf("Lista de clientes:\n")
        for _, c := range g.clients </span><span class="cov0" title="0">{
                fmt.Printf("        - ID: %d. Name: %s\n", c.id, c.name)
        }</span>
        <span class="cov0" title="0">id = ClientID(askUniqueIntID("ID del cliente a eliminar: ", func(n int64) bool </span><span class="cov0" title="0">{ return !g.ownerIDexists(ClientID(n)) }</span>))
        <span class="cov0" title="0">fmt.Println()
        c = g.getClientByID(id)

        vehs := append([]VehicleID(nil), c.vehicles...)
        for _, vid := range vehs </span><span class="cov0" title="0">{
                g.delVByID(vid)
        }</span>
        <span class="cov0" title="0">for i, c := range g.clients </span><span class="cov0" title="0">{
                if c.id == id </span><span class="cov0" title="0">{
                        g.clients = append(g.clients[:i], g.clients[i+1:]...)
                }</span>
        }
}

// Eliminación de 1 vehiculo por matricula
func (g *Garage) delVByID(id VehicleID) <span class="cov0" title="0">{
        var c *Client
        var v *Vehicle

        v = g.getVByID(id)
        for _, issueID := range v.issues </span><span class="cov0" title="0">{
                g.delIssueByID(issueID)
        }</span>
        <span class="cov0" title="0">c = g.getClientByID(v.ownerID)
        for i, vid := range c.vehicles </span><span class="cov0" title="0">{
                if vid == id </span><span class="cov0" title="0">{
                        c.vehicles = append(c.vehicles[:i], c.vehicles[i+1:]...)
                }</span>
        }
        <span class="cov0" title="0">g.extractVfromSlot(id)
        for i, v := range g.vehicles </span><span class="cov0" title="0">{
                if v.id == id </span><span class="cov0" title="0">{
                        g.vehicles = append(g.vehicles[:i], g.vehicles[i+1:]...)
                }</span>
        }
}

// Eliminación de 1 vehiculo
func (g *Garage) delVehicle() <span class="cov0" title="0">{
        var id VehicleID

        if len(g.vehicles) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay vehículos que eliminar)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Eliminación de un Vehículo ===\n\n")
        fmt.Printf("Lista de Matrículas:\n")
        for _, v := range g.vehicles </span><span class="cov0" title="0">{
                fmt.Printf("        - %s\n", v.id)
        }</span>
        <span class="cov0" title="0">fmt.Println()
        id = VehicleID(askUniqueStrID("Matrícula: ", func(s string) bool </span><span class="cov0" title="0">{ return !g.vidExists(VehicleID(s)) }</span>))
        <span class="cov0" title="0">fmt.Println()
        g.delVByID(id)</span>
}

// Eliminación de 1 incidencia
func (g *Garage) delIssue() <span class="cov0" title="0">{
        var id IncidenceID

        if len(g.issues) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay incidencias que eliminar)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Eliminación de una Incidencia ===\n\n")
        fmt.Printf("Lista de IDs de incidencias:\n")
        for _, issue := range g.issues </span><span class="cov0" title="0">{
                fmt.Printf("        - ID: %d\n", issue.id)
        }</span>
        <span class="cov0" title="0">fmt.Println()
        id = IncidenceID(askUniqueIntID("ID de la incidencia a eliminar: ", func(n int64) bool </span><span class="cov0" title="0">{ return !g.issueIDexists(IncidenceID(n)) }</span>))
        <span class="cov0" title="0">fmt.Println()
        g.delIssueByID(id)</span>
}

// Eliminación de una Incidencia dada su ID
func (g *Garage) delIssueByID(id IncidenceID) <span class="cov0" title="0">{

        for i, issue := range g.issues </span><span class="cov0" title="0">{
                if issue.id == id </span><span class="cov0" title="0">{
                        g.issues = append(g.issues[:i], g.issues[i+1:]...)
                }</span>
        }
        <span class="cov0" title="0">for _, m := range g.mechanics </span><span class="cov0" title="0">{
                for i, issue := range m.issues </span><span class="cov0" title="0">{
                        if issue == id </span><span class="cov0" title="0">{
                                m.issues = append(m.issues[:i], m.issues[i+1:]...)
                        }</span>
                }
        }
        <span class="cov0" title="0">for _, v := range g.vehicles </span><span class="cov0" title="0">{
                for i, issue := range v.issues </span><span class="cov0" title="0">{
                        if issue == id </span><span class="cov0" title="0">{
                                v.issues = append(v.issues[:i], v.issues[i+1:]...)
                        }</span>
                }
        }
}

// Eliminación de un mecánico
func (g *Garage) delMech() <span class="cov0" title="0">{
        var id MechanicID

        if len(g.mechanics) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay mecánicos que eliminar)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Eliminación de un mecánico ===\n\n")
        fmt.Printf("Lista de mecánicos:\n")
        for _, m := range g.mechanics </span><span class="cov0" title="0">{
                fmt.Printf("        - ID: %d. Nombre: %s\n", m.id, m.name)
        }</span>
        <span class="cov0" title="0">id = MechanicID(askUniqueIntID("Escoja un ID: ", func(n int64) bool </span><span class="cov0" title="0">{ return !g.mechIDexists(MechanicID(n)) }</span>))
        <span class="cov0" title="0">fmt.Println()
        for _, issue := range g.issues </span><span class="cov0" title="0">{
                for i, mid := range issue.mechanics </span><span class="cov0" title="0">{
                        if mid == id </span><span class="cov0" title="0">{
                                issue.mechanics = append(issue.mechanics[:i], issue.mechanics[i+1:]...)
                        }</span>
                }
        }
        <span class="cov0" title="0">g.slots = g.slots[:len(g.slots)-2]
        for i, m := range g.mechanics </span><span class="cov0" title="0">{
                if m.id == id </span><span class="cov0" title="0">{
                        g.mechanics = append(g.mechanics[:i], g.mechanics[i+1:]...)
                }</span>
        }
}

func delIssueFromMech(m *Mechanic, issue *Incidence) <span class="cov0" title="0">{
        for i, issueID := range m.issues </span><span class="cov0" title="0">{
                if issueID == issue.id </span><span class="cov0" title="0">{
                        m.issues = append(m.issues[:i], m.issues[i+1:]...)
                }</span>
        }
}

func delIssueFromV(v *Vehicle, issue *Incidence) <span class="cov0" title="0">{
        for i, issueID := range v.issues </span><span class="cov0" title="0">{
                if issueID == issue.id </span><span class="cov0" title="0">{
                        v.issues = append(v.issues[:i], v.issues[i+1:]...)
                }</span>
        }
}
</pre>
		
		<pre class="file" id="file2" style="display: none">package main

import (
        "fmt"
        "strings"
)

// listar todas las incidencias en el taller
func (g *Garage) listIssuesInGarage() <span class="cov0" title="0">{
        if len(g.issues) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay incidencias en el taller)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Lista de todas las incidencias en el taller ===\n\n")
        for _, s := range g.slots </span><span class="cov0" title="0">{
                v := g.getVByID(*s.vehicleID)
                for _, isueID := range v.issues </span><span class="cov0" title="0">{
                        i := g.getIssueByID(isueID)
                        g.dispAnIssue(i)
                }</span>
        }
}

// listar los clientes con vehículos en el taller
func (g *Garage) listClientsVInGarage() <span class="cov0" title="0">{

        var noclients = true

        if len(g.clients) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay clientes registrados)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Lista de Clientes con vehículos en el taller ===\n\n")
        for _, c := range g.clients </span><span class="cov0" title="0">{
                if g.hasVInSlot(c) </span><span class="cov0" title="0">{
                        g.dispAclient(c)
                        noclients = false
                }</span>
        }
        <span class="cov0" title="0">if noclients </span><span class="cov0" title="0">{
                fmt.Printf("        (No hay clientes con vehículos en el taller)\n")
        }</span>
}

// Visualizar taller (plazas ocupadas/libres)
func (g *Garage) displaySlots() <span class="cov0" title="0">{
        if len(g.slots) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay mecánicos ni plazas en el taller)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Estado del Taller ===\n\n")
        for _, s := range g.slots </span><span class="cov0" title="0">{
                fmt.Printf("Plaza %d: ", s.number)
                if s.vehicleID == nil </span><span class="cov0" title="0">{
                        fmt.Printf("Libre\n")
                }</span> else<span class="cov0" title="0"> {
                        fmt.Printf("Ocupada\n")
                }</span>
        }
        <span class="cov0" title="0">fmt.Println()</span>
}

// Visualizar 1 cliente
func (g *Garage) dispAclient(c *Client) <span class="cov0" title="0">{
        fmt.Println(strings.Repeat("-", 60)) // 60 guiones seguidos
        fmt.Printf("# Cliente %d\n", c.id)
        fmt.Println(strings.Repeat("-", 60)) // 60 guiones seguidos

        // Datos principales
        fmt.Printf("Nombre:   %s\n", c.name)
        fmt.Printf("Teléfono: %s\n", c.phone)
        fmt.Printf("Email:    %s\n", c.email)
        fmt.Printf("Coches asociados:\n")
        for _, v := range c.vehicles </span><span class="cov0" title="0">{
                fmt.Printf("        - %s\n", v)
        }</span>
        <span class="cov0" title="0">fmt.Println()</span>
}

// Visualizar clientes
func (g *Garage) displayClients() <span class="cov0" title="0">{

        if len(g.clients) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay clientes registrados)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Lista de Clientes ===\n\n")
        for _, c := range g.clients </span><span class="cov0" title="0">{
                g.dispAclient(c)
        }</span>
        <span class="cov0" title="0">fmt.Println()</span>
}

// Visualizar vehículos
func (g *Garage) displayVehicles() <span class="cov0" title="0">{

        if len(g.vehicles) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay vehículos registrados)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Lista de Vehículos ===\n\n")
        for _, v := range g.vehicles </span><span class="cov0" title="0">{
                // Cabecera
                owner := g.getClientByID(v.ownerID)
                fmt.Println(strings.Repeat("-", 60)) // 60 guiones seguidos
                fmt.Printf("# Vehículo %s\n", v.id)
                fmt.Println(strings.Repeat("-", 60)) // 60 guiones seguidos

                // Datos principales
                fmt.Printf("Marca:           %s\n", v.brand)
                fmt.Printf("Modelo:          %s\n", v.model)
                fmt.Printf("Dueño:           %s\n", owner.name)
                if v.checkInAt.IsZero() </span><span class="cov0" title="0">{
                        fmt.Printf("Entrada:         (Por asignar)\n")
                }</span> else<span class="cov0" title="0"> {
                        fmt.Printf("Entrada:         %s\n", v.checkInAt.Format("02/01/2006 15:04"))
                }</span>
                // Incidencias en bloque
                <span class="cov0" title="0">fmt.Printf("Incidencias:\n")
                if len(v.issues) == 0 </span><span class="cov0" title="0">{
                        fmt.Printf("        (Sin Incidencias)")
                }</span> else<span class="cov0" title="0"> {
                        for _, issueID := range v.issues </span><span class="cov0" title="0">{
                                //fmt.Printf("ID: %d\n", issueID)
                                issue := g.getIssueByID(issueID)
                                fmt.Printf("        - ID: %d. ", issue.id)
                                fmt.Printf("Descripción: %s\n", issue.description)
                        }</span>
                }
                <span class="cov0" title="0">fmt.Println()</span>
        }
        <span class="cov0" title="0">fmt.Println()</span>
}

// Visualizar 1 Incidencia
func (g *Garage) dispAnIssue(i *Incidence) <span class="cov0" title="0">{
        // Cabecera
        fmt.Println(strings.Repeat("-", 60))
        fmt.Printf("# Incidencia %d\n", i.id)
        fmt.Println(strings.Repeat("-", 60)) // 60 guiones seguidos

        // Datos principales
        fmt.Printf("Vehículo:   %s\n", i.vehicleID)
        fmt.Printf("Tipo:       %s\n", i.kind)
        fmt.Printf("Prioridad:  %s\n", i.prio)
        fmt.Printf("Estado:     %s\n", i.status)

        // Descripción (en bloque)
        fmt.Println("Descripción:")
        fmt.Printf("  %s\n", i.description)

        // Mecánicos asignados
        if len(i.mechanics) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("Mecánicos:\n        (Sin mecánicos asignados)\n")
        }</span> else<span class="cov0" title="0"> {
                fmt.Println("Mecánicos asignados:")
                for _, mechID := range i.mechanics </span><span class="cov0" title="0">{
                        m := g.getMechByID(mechID)
                        name := "(desconocido)"
                        if m != nil &amp;&amp; m.name != "" </span><span class="cov0" title="0">{
                                name = m.name
                        }</span>
                        <span class="cov0" title="0">fmt.Printf("  - %s\n", name)</span>
                }
        }
        <span class="cov0" title="0">fmt.Println()</span>
}

// Visualizar Incidencias
func (g *Garage) displayIssues() <span class="cov0" title="0">{

        if len(g.issues) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(no hay incidencias)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Println("=== Lista de Incidencias ===")
        for _, i := range g.issues </span><span class="cov0" title="0">{
                g.dispAnIssue(i)
        }</span>
        <span class="cov0" title="0">fmt.Println()</span>
}

// listar Incidencias asignadas a un mecánico
func (g *Garage) dispIssuesOfMech() <span class="cov0" title="0">{
        var mech *Mechanic
        var mid MechanicID

        if len(g.mechanics) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay mecánicos registrados)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("Lista de mecánicos:\n")
        for _, m := range g.mechanics </span><span class="cov0" title="0">{
                fmt.Printf("        - ID: %d. Name: %s\n", m.id, m.name)
        }</span>
        <span class="cov0" title="0">mid = MechanicID(askUniqueIntID("Introduzca el ID del mecánico: ", func(n int64) bool </span><span class="cov0" title="0">{ return !g.mechIDexists(MechanicID(n)) }</span>))
        <span class="cov0" title="0">fmt.Println()
        mech = g.getMechByID(mid)
        fmt.Printf("=== Incidencias asignadas a %s ===\n\n", mech.name)
        for _, isueID := range mech.issues </span><span class="cov0" title="0">{
                i := g.getIssueByID(isueID)
                g.dispAnIssue(i)
        }</span>
}

// Visualizar 1 mecánico
func (g *Garage) displayMech(m *Mechanic) <span class="cov0" title="0">{
        // Cabecera
        fmt.Println(strings.Repeat("-", 60))
        fmt.Printf("# Mecánico %d\n", m.id)
        fmt.Println(strings.Repeat("-", 60)) // 60 guiones seguidos

        // Datos principales
        fmt.Printf("Nombre:       %s\n", m.name)
        fmt.Printf("Especialidad: %s\n", m.skill)
        fmt.Printf("Experiencia:  %d años\n", m.experience)
        fmt.Printf("Estado:       %s\n", m.status)
        fmt.Println()
}</span>

// Visualizar Mecánicos
func (g *Garage) displayMechs() <span class="cov0" title="0">{

        if len(g.mechanics) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay mecánicos registrados)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Lista de Mecánicos ===\n\n")
        for _, m := range g.mechanics </span><span class="cov0" title="0">{
                g.displayMech(m)
        }</span>
        <span class="cov0" title="0">fmt.Println()</span>
}

// Visualizar incidencias de un vehículo
func (g *Garage) listIncFromAvehicle() <span class="cov0" title="0">{
        var vid VehicleID

        if len(g.vehicles) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay vehículos registrados)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Listar Incidencias de 1 Vehículo ===\n\n")
        fmt.Printf("Lista de vehículos:\n")
        for _, v := range g.vehicles </span><span class="cov0" title="0">{
                fmt.Printf("        - %s\n", v.id)
        }</span>
        <span class="cov0" title="0">fmt.Println()
        vid = VehicleID(askUniqueStrID("Escriba la matrícula del vehículo: ", func(s string) bool </span><span class="cov0" title="0">{ return !g.vidExists(VehicleID(s)) }</span>))
        <span class="cov0" title="0">fmt.Println()
        fmt.Printf("=== Incidencias del vehículo %s ===\n\n", vid)
        for _, issueID := range g.getVByID(vid).issues </span><span class="cov0" title="0">{
                i := g.getIssueByID(issueID)
                g.dispAnIssue(i)
        }</span>
}

// Visualizar vehículos de un cliente
func (g *Garage) listVFromClient() <span class="cov0" title="0">{
        var client *Client
        var cid ClientID

        if len(g.clients) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay clientes registrados)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Listar Vehículos de un Cliente ===\n\n")
        fmt.Printf("Lista de clientes:\n")
        for _, c := range g.clients </span><span class="cov0" title="0">{
                fmt.Printf("        - ID: %d. Nombre: %s\n", c.id, c.name)
        }</span>
        <span class="cov0" title="0">fmt.Println()
        cid = ClientID(askUniqueIntID("Introduzca el ID del cliente: ", func(n int64) bool </span><span class="cov0" title="0">{ return !g.ownerIDexists(ClientID(n)) }</span>))
        <span class="cov0" title="0">fmt.Println()
        client = g.getClientByID(cid)
        fmt.Println(strings.Repeat("-", 60)) // 60 guiones seguidos
        fmt.Printf("Vehículos de %s:\n", client.name)
        fmt.Println(strings.Repeat("-", 60)) // 60 guiones seguidos
        if len(client.vehicles) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(Sin vehículos asociados)\n\n")
                return
        }</span>
        <span class="cov0" title="0">for _, vid := range client.vehicles </span><span class="cov0" title="0">{
                v := g.getVByID(vid)
                fmt.Printf("        - Matrícula: %s\n", vid)
                fmt.Printf("                Marca: %s\n", v.brand)
                fmt.Printf("                Modelo: %s\n", v.model)
        }</span>
        <span class="cov0" title="0">fmt.Println()</span>
}

// listar todos los mecáncos disponibles (no asignados a incidencias)
func (g *Garage) listDispMech() <span class="cov0" title="0">{
        var ndisp int = 0

        if len(g.mechanics) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay mecánicos registrados)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Mecánicos Disponibles ===\n\n")
        for _, m := range g.mechanics </span><span class="cov0" title="0">{
                if len(m.issues) == 0 </span><span class="cov0" title="0">{
                        g.displayMech(m)
                        ndisp++
                }</span>
        }
        <span class="cov0" title="0">if ndisp == 0 </span><span class="cov0" title="0">{
                fmt.Printf("\n(No hay mecánicos disponibles)\n")
        }</span>
}
</pre>
		
		<pre class="file" id="file3" style="display: none">package main

import "fmt"

func main() <span class="cov0" title="0">{
        var option int
        var g *Garage

        g = newGarage()
        fmt.Printf("-----------------------------------\n")
        fmt.Printf("- BIENVENIDO AL TALLER LACOSTE.CO -\n")
        fmt.Printf("-----------------------------------\n")
        for </span><span class="cov0" title="0">{
                g.checkAlert()
                fmt.Printf("=== Menú Principal ===\n\n")
                option = polyAskMenuInt("Seleccione una opción:", 7)
                g.checkAlert()
                switch option </span>{
                case 1:<span class="cov0" title="0">
                        fmt.Printf("=== Menú de Creación ===\n\n")
                        option = polyAskMenuInt("Seleccione qué quiere crear: ", 8)
                        creationMenu(option, g)</span>
                case 2:<span class="cov0" title="0">
                        fmt.Printf("=== Menú de Visualización ===\n\n")
                        option = polyAskMenuInt("Seleccione qué visualizar: ", 9)
                        fmt.Println()
                        visualitationMenu(option, g)</span>
                case 3:<span class="cov0" title="0">
                        fmt.Printf("=== Menú de Modificación ===\n\n")
                        option = polyAskMenuInt("Seleccione qué modificar: ", 10)
                        fmt.Println()
                        modificationMenu(option, g)</span>
                case 4:<span class="cov0" title="0">
                        fmt.Printf("=== Menú de Eliminación ===\n\n")
                        option = polyAskMenuInt("Seleccione qué eliminar: ", 11)
                        fmt.Println()
                        deletionMenu(option, g)</span>
                case 5:<span class="cov0" title="0">
                        return</span>
                }
        }
}
</pre>
		
		<pre class="file" id="file4" style="display: none">package main

import "fmt"

// menú de creación
func creationMenu(option int, g *Garage) <span class="cov0" title="0">{
        switch option </span>{
        case 1:<span class="cov0" title="0">
                g.newClient()</span>
        case 2:<span class="cov0" title="0">
                g.newVehicle()</span>
        case 3:<span class="cov0" title="0">
                g.newIssue()</span>
        case 4:<span class="cov0" title="0">
                g.newMech()</span>
        case 5:<span class="cov0" title="0">
                return</span>
        }
}

// menu de visualización
func visualitationMenu(option int, g *Garage) <span class="cov0" title="0">{
        switch option </span>{
        case 1:<span class="cov0" title="0">
                g.displayClients()</span>
        case 2:<span class="cov0" title="0">
                g.displayVehicles()</span>
        case 3:<span class="cov0" title="0">
                g.displayIssues()</span>
        case 4:<span class="cov0" title="0">
                g.displayMechs()</span>
        case 5:<span class="cov0" title="0">
                g.displaySlots()</span>
        case 6:<span class="cov0" title="0">
                g.listIncFromAvehicle()</span>
        case 7:<span class="cov0" title="0">
                g.listVFromClient()</span>
        case 8:<span class="cov0" title="0">
                g.listDispMech()</span>
        case 9:<span class="cov0" title="0">
                g.dispIssuesOfMech()</span>
        case 10:<span class="cov0" title="0">
                g.listClientsVInGarage()</span>
        case 11:<span class="cov0" title="0">
                return</span>
        }
}

// menú de modificacion
func modificationMenu(option int, g *Garage) <span class="cov0" title="0">{
        switch option </span>{
        case 1:<span class="cov0" title="0">
                g.modifyClient()</span>
        case 2:<span class="cov0" title="0">
                g.modifyVehicle()</span>
        case 3:<span class="cov0" title="0">
                g.modifyIssue()</span>
        case 4:<span class="cov0" title="0">
                g.modifyMech()</span>
        case 5:<span class="cov0" title="0">
                g.modifySlots()</span>
        case 6:<span class="cov0" title="0">
                return</span>
        }
}

// menú de eliminación
func deletionMenu(option int, g *Garage) <span class="cov0" title="0">{
        switch option </span>{
        case 1:<span class="cov0" title="0">
                g.delClient()</span>
        case 2:<span class="cov0" title="0">
                g.delVehicle()</span>
        case 3:<span class="cov0" title="0">
                g.delIssue()</span>
        case 4:<span class="cov0" title="0">
                g.delMech()</span>
        case 5:<span class="cov0" title="0">
                return</span>
        }
}

// menú polivalente para asignar especialidad, estados, tipos, etc
func polyAskMenuStr(prompt string, which int) string <span class="cov0" title="0">{
        var strs []string
        var option int

        switch which </span>{
        case 1:<span class="cov0" title="0"> // especialidad de mecanico
                strs = []string{string(MECHSKILL), string(ELECTRICSKILL), string(BODYSKILL)}</span>
        case 2:<span class="cov0" title="0"> // estado mecánico
                strs = []string{string(ACTIVE), string(INACTIVE)}</span>
        case 3:<span class="cov0" title="0"> // tipo incidencia
                strs = []string{string(MECHTYPE), string(ELECTRICTYPE), string(BODYTYPE)}</span>
        case 4:<span class="cov0" title="0"> // prioridad incidencia
                strs = []string{string(LOW), string(MEDIUM), string(HIGH)}</span>
        case 5:<span class="cov0" title="0"> // estado incidencia
                strs = []string{string(OPEN), string(INPROCESS), string(CLOSED)}</span>
        }
        <span class="cov0" title="0">fmt.Printf("%s\n", prompt)
        for </span><span class="cov0" title="0">{
                for i, str := range strs </span><span class="cov0" title="0">{
                        fmt.Printf("        %d. %s\n", i+1, str)
                }</span>
                <span class="cov0" title="0">fmt.Printf("\n")
                fmt.Printf("Opción (número): ")
                fmt.Scanf("%d", &amp;option)
                if option &lt; 1 || option &gt; len(strs) </span><span class="cov0" title="0">{
                        fmt.Printf("Inválida. Pruebe de nuevo")
                }</span> else<span class="cov0" title="0"> {
                        return strs[option-1]
                }</span>
        }
}

// menú polivalente para obtener una opcion segun se requiera
func polyAskMenuInt(prompt string, which int) int <span class="cov0" title="0">{
        var strs []string
        var option int

        switch which </span>{
        case 1:<span class="cov0" title="0"> // Modificación de cliente
                strs = []string{"Cambiar ID", "Cambiar Nombre", "Cambiar teléfono", "Cambiar email"}</span>
        case 2:<span class="cov0" title="0"> // Modificación de vehículo
                strs = []string{"Cambiar matrícula", "Cambiar Marca", "Cambiar Modelo"}</span>
        case 3:<span class="cov0" title="0"> // Modificacion de incidencia
                strs = []string{"Cambiar ID", "Cambiar vehiculo asociado", "Cambiar tipo", "Cambiar prioridad",
                        "Cambiar estado", "Cambiar descripción", "Cambiar mecánicos"}</span>
        case 4:<span class="cov0" title="0"> // gestionar mecánicos en una incidencia
                strs = []string{"Asignar mecánico", "Quitar mecánico"}</span>
        case 5:<span class="cov0" title="0"> // Modificación de un mecánico
                strs = []string{"Cambiar el ID", "Cambiar nombre", "Cambiar especialidad", "Cambiar el estado"}</span>
        case 6:<span class="cov0" title="0"> // asignacion de plazas de taller
                strs = []string{"Meter coche", "Sacar coche", "Volver"}</span>
        case 7:<span class="cov0" title="0"> // menú principal
                strs = []string{"Crear", "Visualizar", "Modificar", "Eliminar", "Salir"}</span>
        case 8:<span class="cov0" title="0"> // menu de creacion
                strs = []string{"Cliente", "Vehículo", "Incidencia", "Mecánico", "Volver"}</span>
        case 9:<span class="cov0" title="0"> // menu de visualizacion
                strs = []string{"Clientes", "Vehiculos", "Incidencias", "Mecánicos", "Estado actual del taller",
                        "Listar Incidencias de un vehículo", "Listar todos los vehículos de un cliente",
                        "Listar todos los mecánicos disponibles", "Listar incidencias asignadas a un mecánico",
                        "Listar todos los clientes con vehículos en el taller", "Volver"}</span>
        case 10:<span class="cov0" title="0"> // menu de modificacion
                strs = []string{"Cliente", "Vehiculo", "Incidencia", "Mecánico",
                        "Asignar vehículos a plazas del taller", "volver"}</span>
        case 11:<span class="cov0" title="0"> // menu de eliminación
                strs = []string{"Cliente", "Vehículo", "Incidencia", "Mecánico", "Volver"}</span>
        }
        <span class="cov0" title="0">fmt.Printf("%s\n", prompt)
        for </span><span class="cov0" title="0">{
                for i, str := range strs </span><span class="cov0" title="0">{
                        fmt.Printf("        %d. %s\n", i+1, str)
                }</span>
                <span class="cov0" title="0">fmt.Printf("\n")
                fmt.Printf("Opción (número): ")
                fmt.Scanf("%d", &amp;option)
                if option &lt; 1 || option &gt; len(strs) </span><span class="cov0" title="0">{
                        fmt.Printf("Inválida. Pruebe de nuevo")
                }</span> else<span class="cov0" title="0"> {
                        return option
                }</span>
        }
}
</pre>
		
		<pre class="file" id="file5" style="display: none">package main

import (
        "fmt"
        "time"
)

// modificar el id de un cliente
func (g *Garage) modifyClientID(c *Client, cid ClientID) <span class="cov0" title="0">{
        c.id = ClientID(askUniqueIntID("Introduzca un nuevo ID: ", func(n int64) bool </span><span class="cov0" title="0">{ return g.ownerIDexists(ClientID(n)) }</span>))
        <span class="cov0" title="0">for _, v := range g.vehicles </span><span class="cov0" title="0">{
                if cid == v.ownerID </span><span class="cov0" title="0">{
                        v.ownerID = c.id
                }</span>
        }
}

// modificación de cliente
func (g *Garage) modifyClient() <span class="cov0" title="0">{
        var option int
        var client *Client
        var cid ClientID

        if len(g.clients) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay Clientes que modificar)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Modificación de Cliente ===\n\n")
        fmt.Printf("Lista de IDs de los clientes\n")
        for _, c := range g.clients </span><span class="cov0" title="0">{
                fmt.Printf("        - ID: %d. Name: %s\n", c.id, c.name)
        }</span>
        <span class="cov0" title="0">fmt.Println()
        cid = ClientID(askUniqueIntID("Introduzca el ID del cliente a modificar: ", func(n int64) bool </span><span class="cov0" title="0">{ return !g.ownerIDexists(ClientID(n)) }</span>))
        <span class="cov0" title="0">client = g.getClientByID(cid)
        option = polyAskMenuInt("Seleccione lo que desee modificar.", 1)
        switch option </span>{
        case 1:<span class="cov0" title="0">
                g.modifyClientID(client, cid)</span>
        case 2:<span class="cov0" title="0">
                client.name = askStr("Introduzca un nuevo nombre: ")</span>
        case 3:<span class="cov0" title="0">
                client.phone = askStr("Introduzca nuevo teléfono: ")</span>
        case 4:<span class="cov0" title="0">
                client.email = askStr("Introduzca nuevo email: ")</span>
        }
}

// modificar matrícula de un coche
func (g *Garage) modifIDvehicle(v *Vehicle, vid VehicleID) <span class="cov0" title="0">{
        var c *Client

        v.id = VehicleID(askUniqueStrID("Introduzca una nueva matrícula: ", func(s string) bool </span><span class="cov0" title="0">{ return g.vidExists(VehicleID(s)) }</span>))
        <span class="cov0" title="0">c = g.getClientByID(v.ownerID)
        for idx, idv := range c.vehicles </span><span class="cov0" title="0">{ // actualizar matriculas asociadas a cliente
                if idv == vid </span><span class="cov0" title="0">{
                        c.vehicles[idx] = v.id
                }</span>
        }
        <span class="cov0" title="0">for _, issueID := range v.issues </span><span class="cov0" title="0">{ // actualizar las incidencias asociadas a la nueva matricula
                issue := g.getIssueByID(issueID)
                issue.vehicleID = v.id
        }</span>
        <span class="cov0" title="0">for _, s := range g.slots </span><span class="cov0" title="0">{ // actualizar la matrícula en los slots en los que está
                if s.vehicleID != nil &amp;&amp; *s.vehicleID == vid </span><span class="cov0" title="0">{
                        *s.vehicleID = v.id
                }</span>
        }
}

// modificación de vehículos
func (g *Garage) modifyVehicle() <span class="cov0" title="0">{
        var option int
        var vehicle *Vehicle
        var vid VehicleID

        if len(g.vehicles) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay vehículos por modificar)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Modificación de un Vehículo ===\n\n")
        fmt.Printf("Lista de Vehículos\n")
        for _, v := range g.vehicles </span><span class="cov0" title="0">{
                fmt.Printf("        - %s\n", v.id)
        }</span>
        <span class="cov0" title="0">fmt.Println()
        vid = VehicleID(askUniqueStrID("Introduzca la matrícula del vehículo a modificar: ", func(s string) bool </span><span class="cov0" title="0">{ return !g.vidExists(VehicleID(s)) }</span>))
        <span class="cov0" title="0">vehicle = g.getVByID(vid)
        option = polyAskMenuInt("Seleccione lo que desee modificar.", 2)
        switch option </span>{
        case 1:<span class="cov0" title="0">
                g.modifIDvehicle(vehicle, vid)</span>
        case 2:<span class="cov0" title="0">
                vehicle.brand = askStr("Introduzca nueva Marca: ")</span>
        case 3:<span class="cov0" title="0">
                vehicle.model = askStr("Introduzca nuevo Modelo: ")</span>
        }
}

// Modificar el ID de una incidencia
func (g *Garage) modifyIDissue(i *Incidence, oldid IncidenceID) <span class="cov0" title="0">{
        i.id = IncidenceID(askUniqueIntID("Introduzca un nuevo ID: ", func(n int64) bool </span><span class="cov0" title="0">{ return g.issueIDexists(IncidenceID(n)) }</span>))
        <span class="cov0" title="0">for _, v := range g.vehicles </span><span class="cov0" title="0">{
                for idx := range v.issues </span><span class="cov0" title="0">{
                        if v.issues[idx] == oldid </span><span class="cov0" title="0">{
                                v.issues[idx] = i.id
                        }</span>
                }
        }
        <span class="cov0" title="0">for _, m := range g.mechanics </span><span class="cov0" title="0">{
                for idx := range m.issues </span><span class="cov0" title="0">{
                        if m.issues[idx] == oldid </span><span class="cov0" title="0">{
                                m.issues[idx] = i.id
                        }</span>
                }
        }
}

// cambiar de vehiculo asociado a una incidencia
func (g *Garage) modifyAsignVIssue(i *Incidence) <span class="cov0" title="0">{
        var oldv *Vehicle
        var newv *Vehicle

        if len(g.vehicles) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay vehículos para asignar)\n\n")
                return
        }</span>
        <span class="cov0" title="0">oldv = g.getVByID(i.vehicleID)
        fmt.Printf("Lista de vehículos a asignar.\n")
        for _, v := range g.vehicles </span><span class="cov0" title="0">{
                if oldv.id != v.id </span><span class="cov0" title="0">{
                        fmt.Printf("        - %s\n", v.id)
                }</span>
        }
        <span class="cov0" title="0">fmt.Println()
        i.vehicleID = VehicleID(askUniqueStrID("Introduzca la mátricula que desea asignar: ", func(s string) bool </span><span class="cov0" title="0">{ return !g.vidExists(VehicleID(s)) }</span>))
        <span class="cov0" title="0">newv = g.getVByID(i.vehicleID)
        newv.issues = append(newv.issues, i.id)
        for idx, issueID := range oldv.issues </span><span class="cov0" title="0">{
                if issueID == i.id </span><span class="cov0" title="0">{
                        oldv.issues = append(oldv.issues[:idx], oldv.issues[idx+1:]...)
                }</span>
        }
}

// modificar el ID de un mecánico
func (g *Garage) modifIDMech(m *Mechanic, oldid MechanicID) <span class="cov0" title="0">{
        m.id = MechanicID(askUniqueIntID("Introduzca un nuevo ID: ", func(n int64) bool </span><span class="cov0" title="0">{ return g.mechIDexists(MechanicID(n)) }</span>))
        <span class="cov0" title="0">for i, issue := range g.issues </span><span class="cov0" title="0">{
                for k, mid := range issue.mechanics </span><span class="cov0" title="0">{
                        if mid == oldid </span><span class="cov0" title="0">{
                                g.issues[i].mechanics[k] = m.id
                        }</span>
                }
        }
}

// modificación de un mecánico
func (g *Garage) modifyMech() <span class="cov0" title="0">{
        var mech *Mechanic
        var mid MechanicID
        var option int

        if len(g.mechanics) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay mecánicos disponibles)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Modificación de mecánico ===\n\n")
        fmt.Printf("Lista de mecánicos:\n")
        for _, m := range g.mechanics </span><span class="cov0" title="0">{
                fmt.Printf("        - ID: %d. Name: %s\n", m.id, m.name)
        }</span>
        <span class="cov0" title="0">fmt.Println()
        mid = MechanicID(askUniqueIntID("Introduzca el ID del mecánico a modificar: ", func(n int64) bool </span><span class="cov0" title="0">{ return !g.mechIDexists(MechanicID(n)) }</span>))
        <span class="cov0" title="0">option = polyAskMenuInt("Seleccione lo que desee modificar.", 5)
        fmt.Println()
        mech = g.getMechByID(mid)
        switch option </span>{
        case 1:<span class="cov0" title="0">
                g.modifIDMech(mech, mid)</span>
        case 2:<span class="cov0" title="0">
                mech.name = askStr("Introduzca el nuevo nombre: ")</span>
        case 3:<span class="cov0" title="0">
                mech.skill = SkillType(polyAskMenuStr("Seleccione especialidad.", 1))</span>
        case 4:<span class="cov0" title="0">
                mech.status = MechStatus(polyAskMenuStr("Seleccione el estado.", 2))</span>
        }

}

// cambiar mecánicos en una incidencia
func (g *Garage) asignMechs(issue *Incidence) <span class="cov0" title="0">{
        var option int

        option = polyAskMenuInt("Seleccione si desea asignar o quitar mecánicos", 4)
        fmt.Println()
        switch option </span>{
        case 1:<span class="cov0" title="0">
                g.assignMechsToIssue(issue)</span>
        case 2:<span class="cov0" title="0">
                g.removeMechsFromIssue(issue)</span>
        }
}

// Modificar incidencia
func (g *Garage) modifyIssue() <span class="cov0" title="0">{
        var issueID IncidenceID
        var issue *Incidence
        var option int

        if len(g.issues) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay incidencias aún)\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("=== Modificación de Incidencia ===\n\n")
        fmt.Printf("Lista de Incidencias\n")
        for _, i := range g.issues </span><span class="cov0" title="0">{
                fmt.Printf("        - ID: %d\n", i.id)
        }</span>
        <span class="cov0" title="0">fmt.Println()
        issueID = IncidenceID(askUniqueIntID("Introduzca el ID de la incidencia a modificar: ", func(n int64) bool </span><span class="cov0" title="0">{ return !g.issueIDexists(IncidenceID(n)) }</span>))
        <span class="cov0" title="0">issue = g.getIssueByID(issueID)
        option = polyAskMenuInt("Seleccione lo que desee modificar", 3)
        fmt.Println()
        switch option </span>{
        case 1:<span class="cov0" title="0">
                g.modifyIDissue(issue, issueID)</span>
        case 2:<span class="cov0" title="0">
                g.modifyAsignVIssue(issue)</span>
        case 3:<span class="cov0" title="0">
                issue.kind = IssueType(polyAskMenuStr("Seleccione tipo:", 3))</span>
        case 4:<span class="cov0" title="0">
                issue.prio = Priority(polyAskMenuStr("Seleccione prioridad:", 4))</span>
        case 5:<span class="cov0" title="0">
                issue.status = IssueStatus(polyAskMenuStr("Seleccione el estado:", 5))</span>
        case 6:<span class="cov0" title="0">
                issue.description = askStr("Redacte la descripción:\n")</span>
        case 7:<span class="cov0" title="0">
                g.asignMechs(issue)</span>
        }
}

// meter un vehiculo a una plaza del taller
func (g *Garage) addV() <span class="cov0" title="0">{
        var vid VehicleID

        if g.availableSlots() == 0 </span><span class="cov0" title="0">{
                fmt.Printf("No hay plazas disponibles, espere o saque un vehículo antes.\n\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("Vehículos no asignados a una plaza:\n")
        for _, v := range g.vehicles </span><span class="cov0" title="0">{
                if !g.vIsInSlot(v.id) </span><span class="cov0" title="0">{
                        fmt.Printf("        - %s\n", v.id)
                }</span>
        }
        <span class="cov0" title="0">fmt.Println()
        vid = VehicleID(askUniqueStrID("Introduzca la matrícula del vehiculo a asignar: ", func(s string) bool </span><span class="cov0" title="0">{ return !g.vidExists(VehicleID(s)) }</span>))
        <span class="cov0" title="0">go g.assignVtoSlot(vid)</span>
}

// modificar plazas el taller
func (g *Garage) modifySlots() <span class="cov0" title="0">{

        if len(g.slots) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("(No hay plazas disponibles, contrate mecánico)\n\n")
                return
        }</span>
        <span class="cov0" title="0">g.addV()</span>
}

// devuelve un mecánico que está libre
func (g *Garage) getFreeMech() *Mechanic <span class="cov0" title="0">{
        for _, m := range g.mechanics </span><span class="cov0" title="0">{
                if isFree(m) </span><span class="cov0" title="0">{
                        return m
                }</span>
        }
        <span class="cov0" title="0">return nil</span>
}

func (g *Garage) autoAsignMtoIssues(m *Mechanic, issues []*Incidence) <span class="cov0" title="0">{

        for _, i := range issues </span><span class="cov0" title="0">{
                m.issues = append(m.issues, i.id)
                i.mechanics = append(i.mechanics, m.id)
        }</span>
}

func (g *Garage) waitForFreeMech() *Mechanic <span class="cov0" title="0">{
        var m *Mechanic
        for </span><span class="cov0" title="0">{
                m = g.getFreeMech()
                if m != nil </span><span class="cov0" title="0">{
                        return m
                }</span>
                <span class="cov0" title="0">time.Sleep(1 * time.Second)</span>
        }
}

func setPrioAndStatus(issues []*Incidence) <span class="cov0" title="0">{
        for _, i := range issues </span><span class="cov0" title="0">{
                i.prio = HIGH
                i.status = INPROCESS
        }</span>
}

func closeIssues(issues []*Incidence) <span class="cov0" title="0">{
        for _, i := range issues </span><span class="cov0" title="0">{
                i.status = CLOSED
        }</span>
}

// sacar un vehículo de la plaza del taller
func (g *Garage) extractVfromSlot(vid VehicleID) <span class="cov0" title="0">{
        for _, s := range g.slots </span><span class="cov0" title="0">{
                if s.vehicleID != nil &amp;&amp; *s.vehicleID == vid </span><span class="cov0" title="0">{
                        s.vehicleID = nil
                }</span>
        }
}

func (g *Garage) assignVtoSlot(vid VehicleID) <span class="cov0" title="0">{
        vehicle := g.getVByID(vid)
        if vehicle == nil || len(vehicle.issues) == 0 </span><span class="cov0" title="0">{
                return
        }</span>

        // 1) Obtener mecánico principal (esperando si hace falta)
        <span class="cov0" title="0">mainMech := g.obtainMechanicForVehicle(vid)

        // 2) Meter vehículo en una plaza
        if !g.placeVehicleInSlot(vid) </span><span class="cov0" title="0">{
                // si no hubiera slot libre (por seguridad)
                return
        }</span>

        // 3) Recoger incidencias y calcular ETA
        <span class="cov0" title="0">issues, eta := g.collectIssuesAndEta(vehicle)
        vehicle.eta = eta

        // 4) Asignar mecánico principal
        g.autoAsignMtoIssues(mainMech, issues)

        // 5) Posible segundo mecánico
        var extraMech *Mechanic
        if eta &gt; 15*time.Second </span><span class="cov0" title="0">{
                extraMech = g.obtainSecondMechanic(vid)
                setPrioAndStatus(issues)
                g.autoAsignMtoIssues(extraMech, issues)
        }</span>

        // 6) Simular reparación
        <span class="cov0" title="0">time.Sleep(eta)

        // 7) Cerrar incidencias y liberar recursos
        closeIssues(issues)
        g.extractVfromSlot(vid)

        for _, inc := range issues </span><span class="cov0" title="0">{
                delIssueFromMech(mainMech, inc)
                if extraMech != nil </span><span class="cov0" title="0">{
                        delIssueFromMech(extraMech, inc)
                }</span>
                <span class="cov0" title="0">delIssueFromV(vehicle, inc)</span>
        }
}

// 1) Mecánico principal (usa vpool + wait)
func (g *Garage) obtainMechanicForVehicle(vid VehicleID) *Mechanic <span class="cov0" title="0">{
        if m := g.getFreeMech(); m != nil </span><span class="cov0" title="0">{
                return m
        }</span>

        // nadie libre -&gt; coche a la cola de espera
        <span class="cov0" title="0">g.vpool = append(g.vpool, vid)
        m := g.waitForFreeMech()
        g.vpool = removeVID(g.vpool, vid)
        return m</span>
}

// 2) Colocar vehículo en un slot libre
func (g *Garage) placeVehicleInSlot(vid VehicleID) bool <span class="cov0" title="0">{
        for i := range g.slots </span><span class="cov0" title="0">{
                if g.slots[i].vehicleID == nil </span><span class="cov0" title="0">{
                        g.slots[i].vehicleID = &amp;vid
                        return true
                }</span>
        }
        <span class="cov0" title="0">return false</span>
}

// 3) Construir slice de incidencias y calcular ETA
func (g *Garage) collectIssuesAndEta(v *Vehicle) ([]*Incidence, time.Duration) <span class="cov0" title="0">{
        var (
                issues []*Incidence
                eta    time.Duration
        )

        for _, issueID := range v.issues </span><span class="cov0" title="0">{
                inc := g.getIssueByID(issueID)
                if inc == nil </span><span class="cov0" title="0">{
                        continue</span>
                }
                <span class="cov0" title="0">issues = append(issues, inc)

                switch inc.kind </span>{
                case MECHTYPE:<span class="cov0" title="0">
                        eta += 5 * time.Second</span>
                case ELECTRICTYPE:<span class="cov0" title="0">
                        eta += 7 * time.Second</span>
                default:<span class="cov0" title="0">
                        eta += 11 * time.Second</span>
                }
        }
        <span class="cov0" title="0">return issues, eta</span>
}

// 4) Segundo mecánico (libre o contratado)
func (g *Garage) obtainSecondMechanic(vid VehicleID) *Mechanic <span class="cov0" title="0">{
        if m := g.getFreeMech(); m != nil </span><span class="cov0" title="0">{
                return m
        }</span>
        <span class="cov0" title="0">req := HireRequest{
                vid:   vid,
                Reply: make(chan *Mechanic),
        }
        g.hirereqs &lt;- req
        return &lt;-req.Reply</span>
}
</pre>
		
		<pre class="file" id="file6" style="display: none">package main

import (
        "bufio"
        "fmt"
        "os"
        "time"
)

// Constructor default de un nuevo taller
func newGarage() *Garage <span class="cov8" title="1">{
        return &amp;Garage{
                clients:   nil,
                vehicles:  nil,
                mechanics: nil,
                issues:    nil,
                slots:     nil,
                vpool:     nil,
                hirereqs:  make(chan HireRequest),
        }
}</span>

// CREAR un CLIENTE
func (g *Garage) newClient() <span class="cov0" title="0">{
        var c Client

        c.id = ClientID(askUniqueIntID("ID cliente (&gt;0): ", func(n int64) bool </span><span class="cov0" title="0">{ return g.ownerIDexists(ClientID(n)) }</span>))
        <span class="cov0" title="0">fmt.Printf("Nombre: ")
        fmt.Scanf("%s", &amp;c.name)
        fmt.Printf("Teléfono: ")
        fmt.Scanf("%s", &amp;c.phone)
        fmt.Printf("Email: ")
        fmt.Scanf("%s", &amp;c.email)
        g.clients = append(g.clients, &amp;c)</span>
}

// CREAR VEHÍCULO
func (g *Garage) newVehicle() <span class="cov0" title="0">{
        var v Vehicle
        var client *Client

        if len(g.clients) == 0 </span><span class="cov0" title="0">{
                fmt.Printf("No hay aún clientes registrados, registre uno primero.\n")
                return
        }</span>
        <span class="cov0" title="0">fmt.Printf("¿Cuál es el dueño? escoja un ID:\n\n")
        for _, c := range g.clients </span><span class="cov0" title="0">{
                fmt.Printf("        - ID: %d. Cliente: %s\n", c.id, c.name)
        }</span>
        <span class="cov0" title="0">v.ownerID = ClientID(askUniqueIntID("Dueño: ", func(n int64) bool </span><span class="cov0" title="0">{ return !g.ownerIDexists(ClientID(n)) }</span>))
        <span class="cov0" title="0">v.id = VehicleID(askUniqueStrID("Matrícula: ", func(s string) bool </span><span class="cov0" title="0">{ return g.vidExists(VehicleID(s)) }</span>))
        <span class="cov0" title="0">client = g.getClientByID(v.ownerID)
        client.vehicles = append(client.vehicles, v.id)
        fmt.Printf("Marca: ")
        fmt.Scanf("%s", &amp;v.brand)
        fmt.Printf("Modelo: ")
        fmt.Scanf("%s", &amp;v.model)
        v.checkInAt = time.Now().Add(time.Duration(-30) * time.Hour)
        v.eta = 0 * time.Second
        g.vehicles = append(g.vehicles, &amp;v)</span>
}

func (g *Garage) genSlots() <span class="cov8" title="1">{
        for i := 0; i &lt; 2; i++ </span><span class="cov8" title="1">{
                g.slots = append(g.slots, &amp;Slot{
                        number:    len(g.slots) + 1,
                        vehicleID: nil, // puntero al ID existente en el slice (dirección estable)
                })
        }</span>
}

// CREAR MECÁNICO
func (g *Garage) newMech() *Mechanic <span class="cov0" title="0">{
        var m Mechanic

        // ampliar plazas del taller
        g.genSlots()
        m.id = MechanicID(askUniqueIntID("ID del mecánico: ", func(n int64) bool </span><span class="cov0" title="0">{ return g.mechIDexists(MechanicID(n)) }</span>))
        <span class="cov0" title="0">fmt.Printf("Nombre: ")
        fmt.Scanf("%s", &amp;m.name)
        fmt.Printf("Experiencia(años): ")
        fmt.Scanf("%d", &amp;m.experience)
        m.skill = SkillType(polyAskMenuStr("Seleccione una especialidad:", 1))
        m.status = MechStatus(polyAskMenuStr("Seleccione un estado:", 2))
        g.mechanics = append(g.mechanics, &amp;m)
        return g.mechanics[len(g.mechanics)-1]</span>
}

// CREAR INCIDENCIA
func (g *Garage) newIssue() <span class="cov0" title="0">{
        var i Incidence
        var v *Vehicle

        i.id = IncidenceID(askUniqueIntID("ID de la incidencia: ", func(n int64) bool </span><span class="cov0" title="0">{ return g.issueIDexists(IncidenceID(n)) }</span>))
        <span class="cov0" title="0">fmt.Printf("Escriba la matrícula del coche que sufre la incidencia:\n")
        for _, v := range g.vehicles </span><span class="cov0" title="0">{
                fmt.Printf("        - %s\n", v.id)
        }</span>
        <span class="cov0" title="0">fmt.Println()
        i.vehicleID = VehicleID(askUniqueStrID("Matrícula: ", func(s string) bool </span><span class="cov0" title="0">{ return !g.vidExists(VehicleID(s)) }</span>))
        <span class="cov0" title="0">fmt.Println()
        v = g.getVByID(i.vehicleID)
        v.issues = append(v.issues, i.id)
        i.kind = IssueType(polyAskMenuStr("Tipo de incidencia:", 3))
        fmt.Println()
        //i.prio = Priority(polyAskMenuStr("Prioridad:", 4))
        //fmt.Println()
        i.prio = LOW
        i.status = OPEN
        //i.status = IssueStatus(polyAskMenuStr("Estado:", 5))
        //fmt.Println()
        //g.assignMechsToIssue(&amp;i)
        //fmt.Println()
        fmt.Printf("Redacte la Descripción de la incidencia:\n")
        scanner := bufio.NewScanner(os.Stdin)
        scanner.Scan()
        i.description = scanner.Text()

        g.issues = append(g.issues, &amp;i)</span>
}
</pre>
		
		</div>
	</body>
	<script>
	(function() {
		var files = document.getElementById('files');
		var visible;
		files.addEventListener('change', onChange, false);
		function select(part) {
			if (visible)
				visible.style.display = 'none';
			visible = document.getElementById(part);
			if (!visible)
				return;
			files.value = part;
			visible.style.display = 'block';
			location.hash = part;
		}
		function onChange() {
			select(files.value);
			window.scrollTo(0, 0);
		}
		if (location.hash != "") {
			select(location.hash.substr(1));
		}
		if (!visible) {
			select("file0");
		}
	})();
	</script>
</html>
